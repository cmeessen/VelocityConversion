
<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python module &mdash; VelocityConversion v.1.1.1+21.g0db4c96.dirty documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="_static/copy_button.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/copy_button.js"></script>
        <script src="_static/clipboard.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Terminal application" href="as_terminal.html" />
    <link rel="prev" title="Installation" href="installation.html" />
 

</script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> VelocityConversion
          </a>
              <div class="version">
                v.1.1.1+21.g0db4c96.dirty
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#input-data">Input data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-a-mantle-assemblage">Defining a mantle assemblage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#start-the-conversion">Start the conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#results">Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#saving-to-file">Saving to file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#optional-settings">Optional settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pressure-reference-model">Pressure reference model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#attenuation-parameters">Attenuation parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#thermal-expansion-coefficients">Thermal expansion coefficients</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="as_terminal.html">Terminal application</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>


    
        <p class="caption">
            <span class="caption-text">
            
                More
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://github.com/cmeessen/VelocityConversion"><i class="fa fa-github fw"></i> GitHub repository</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/cmeessen/VelocityConversion/issues/new"><i class="fa fa-bug fw"></i> Open an issue</a></li>
            
                <li class="toctree-l1"><a href="https://www.zenodo.org/badge/latestdoi/87794116"><i class="fa fa-quote-left fw"></i> Cite VelocityConversion</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VelocityConversion</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Python module</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/cmeessen/pyGMS/blob/master/docs/sphinxas_module.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-module">
<span id="as-module"></span><h1>Python module<a class="headerlink" href="#python-module" title="Permalink to this headline"></a></h1>
<p>Follow the steps outlined in <cite>_installation</cite>, in order to be able to use
<code class="xref py py-mod docutils literal notranslate"><span class="pre">VelocityConversion</span></code> as a Python module. Start with importing the main
class:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="kn">from</span> <span class="nn">VelocityConversion</span> <span class="kn">import</span> <span class="n">MantleConversion</span>

<span class="gp">In [2]: </span><span class="n">MC</span> <span class="o">=</span> <span class="n">MantleConversion</span><span class="p">()</span>
</pre></div>
</div>
<section id="input-data">
<h2>Input data<a class="headerlink" href="#input-data" title="Permalink to this headline"></a></h2>
<p>The input data can be loaded from a <strong>file</strong> or provided as a <strong>numpy array</strong>.
The data should be organised in columns:</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 24%" />
<col style="width: 20%" />
<col style="width: 35%" />
<col style="width: 20%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Column</strong></p></td>
<td><p><strong>Name</strong></p></td>
<td><p><strong>Description</strong></p></td>
<td><p><strong>Unit</strong></p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>X</p></td>
<td><p>A coordinate</p></td>
<td><p>Anything</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Y</p></td>
<td><p>A coordinate</p></td>
<td><p>Anything</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Z</p></td>
<td><p>Depth</p></td>
<td><p>masl</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>v</p></td>
<td><p>Velocity</p></td>
<td><p>m/s</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>To load data from a file, use
<code class="xref py py-meth docutils literal notranslate"><span class="pre">LoadFile()</span></code>.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [3]: </span><span class="n">MC</span><span class="o">.</span><span class="n">LoadFile</span><span class="p">(</span><span class="s1">&#39;../../Examples/VsSL2013.dat&#39;</span><span class="p">)</span>
<span class="go">Loading input file: ../../Examples/VsSL2013.dat</span>
<span class="go">&gt; Velocity scale factor is 1.0</span>
</pre></div>
</div>
<p>Alternatively, the data can be provided as a numpy array using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">LoadArray()</span></code>. When providing the data
as a numpy array, it should have the shape <code class="docutils literal notranslate"><span class="pre">[nrows,</span> <span class="pre">4]</span></code>. This example shows
the numpy array structure by simply displaying the array loaded from the file
above:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="go"># Adjust numpy just for some prettier printing of the array</span>
<span class="gp">In [4]: </span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">MC</span><span class="o">.</span><span class="n">DataRaw</span>
<span class="gh">Out[5]: </span><span class="go"></span>
<span class="go">array([[      0.  , 6000000.  ,  -50000.  ,    4287.65],</span>
<span class="go">       [ 100000.  , 6000000.  ,  -50000.  ,    4268.31],</span>
<span class="go">       [ 200000.  , 6000000.  ,  -50000.  ,    4199.97],</span>
<span class="go">       ...,</span>
<span class="go">       [1000000.  , 7800000.  , -200000.  ,    4329.93],</span>
<span class="go">       [1100000.  , 7800000.  , -200000.  ,    4338.  ],</span>
<span class="go">       [1200000.  , 7800000.  , -200000.  ,    4352.14]])</span>
</pre></div>
</div>
<p>In any case, the velocity type needs to be provided with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SetVelType()</span></code> (<code class="docutils literal notranslate"><span class="pre">S</span></code> or <code class="docutils literal notranslate"><span class="pre">P</span></code>):</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="n">MC</span><span class="o">.</span><span class="n">SetVelType</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="defining-a-mantle-assemblage">
<h2>Defining a mantle assemblage<a class="headerlink" href="#defining-a-mantle-assemblage" title="Permalink to this headline"></a></h2>
<p>The mineralogical assemblage of the mantle rocks must be provided. The
assemblage is defined by denoting the fractional proportion of a mineral phase
of the mantle rock. It can be defined either by using a Python dictionary, or
loaded from a file using <code class="xref py py-meth docutils literal notranslate"><span class="pre">LoadMineralogy()</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">assemblage</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;ol&quot;</span><span class="p">:</span> <span class="mf">0.67</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;cpx&quot;</span><span class="p">:</span> <span class="mf">0.045</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;opx&quot;</span><span class="p">:</span> <span class="mf">0.225</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;gnt&quot;</span><span class="p">:</span> <span class="mf">0.06</span><span class="p">,</span>
<span class="gp">   ...: </span>    <span class="s2">&quot;XFe&quot;</span><span class="p">:</span> <span class="mf">0.11</span>
<span class="gp">   ...: </span><span class="p">}</span>
<span class="gp">   ...: </span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">XFe</span></code> is the molar iron content of the rock and is optional. It can also
be defined by calling <code class="xref py py-meth docutils literal notranslate"><span class="pre">SetXFe()</span></code>.</p>
</div>
<p>The available mineral phases are provided in the <code class="docutils literal notranslate"><span class="pre">MinDB.csv</span></code>. This file can
be edited freely if new phase information is available.</p>
<p>To defined the composition, call
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SetMineralogy()</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [8]: </span><span class="n">MC</span><span class="o">.</span><span class="n">SetMineralogy</span><span class="p">(</span><span class="n">assemblage</span><span class="p">)</span>
<span class="go">&gt; XFe assigned to 0.11</span>
<span class="go">&gt; All mineral phases are known</span>
<span class="go">&gt; Sum of mineral phases equals 1.0</span>
</pre></div>
</div>
<p>or call <code class="xref py py-meth docutils literal notranslate"><span class="pre">DefaultMineralogy()</span></code> in order
to set the default composition (garnet lherzolite by Jordan, 1979).</p>
</section>
<section id="start-the-conversion">
<h2>Start the conversion<a class="headerlink" href="#start-the-conversion" title="Permalink to this headline"></a></h2>
<p>To start the conversion, simply run
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Convert()</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">MC</span><span class="o">.</span><span class="n">Convert</span><span class="p">()</span>
<span class="go">Filling tables</span>
<span class="go">&gt; Number of depth values: 5</span>
<span class="go">&gt; Number of temperatures: 2701</span>
<span class="go">&gt; Pressure calculation  : AK135</span>
<span class="go">&gt; T range: 300.0 to 3000.0 steps 1.0</span>
<span class="go">Starting temperature estimation</span>
<span class="go">&gt; Progress: 0%</span>
<span class="go">&gt; Progress: 0%</span>
<span class="go">&gt; Progress: 20%</span>
<span class="go">&gt; Progress: 40%</span>
<span class="go">&gt; Progress: 60%</span>
<span class="go">&gt; Progress: 100%</span>
<span class="go">&gt; Done!</span>
</pre></div>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline"></a></h2>
<p>The results are stored in two 1D arrays named <code class="docutils literal notranslate"><span class="pre">Result_T</span></code> and <code class="docutils literal notranslate"><span class="pre">Result_Rho</span></code>.
The order of the data in these arrays corresponds to the order of the points
in the input file.</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [10]: </span><span class="nb">print</span><span class="p">(</span><span class="n">MC</span><span class="o">.</span><span class="n">Result_T</span><span class="p">)</span>
<span class="go">[1288.78 1301.07 1341.16 ... 1552.29 1546.6  1536.44]</span>

<span class="gp">In [11]: </span><span class="nb">print</span><span class="p">(</span><span class="n">MC</span><span class="o">.</span><span class="n">Result_Rho</span><span class="p">)</span>
<span class="go">[3311.46 3310.48 3307.29 ... 3407.16 3407.53 3408.18]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The temperatures in <code class="docutils literal notranslate"><span class="pre">Result_T</span></code> are in <strong>Kelvin</strong>!</p>
</div>
<p>We can plot the results for 50km depth:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [12]: </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">   ....: </span><span class="kn">from</span> <span class="nn">matplotlib.tri</span> <span class="kn">import</span> <span class="n">Triangulation</span>
<span class="gp">   ....: </span>
<span class="gp">   ....: </span><span class="k">def</span> <span class="nf">make_plot</span><span class="p">(</span><span class="n">MCObject</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">   ....: </span>    <span class="n">indices</span> <span class="o">=</span> <span class="n">MCObject</span><span class="o">.</span><span class="n">DataRaw</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">depth</span>
<span class="gp">   ....: </span>    <span class="n">depth_slice</span> <span class="o">=</span> <span class="n">MCObject</span><span class="o">.</span><span class="n">DataRaw</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="n">velocity</span> <span class="o">=</span> <span class="n">depth_slice</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="n">temperature</span> <span class="o">=</span> <span class="n">MCObject</span><span class="o">.</span><span class="n">Result_T</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="n">density</span> <span class="o">=</span> <span class="n">MCObject</span><span class="o">.</span><span class="n">Result_Rho</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="n">tri</span> <span class="o">=</span> <span class="n">Triangulation</span><span class="p">(</span><span class="n">depth_slice</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span><span class="p">,</span>
<span class="gp">   ....: </span>                        <span class="n">depth_slice</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1000.</span><span class="p">)</span>
<span class="gp">   ....: </span>    <span class="n">m_v</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">tri</span><span class="p">,</span> <span class="n">velocity</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3500</span><span class="p">,</span> <span class="mi">4700</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">   ....: </span>    <span class="n">m_t</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">tri</span><span class="p">,</span> <span class="n">temperature</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hot&#39;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">950</span><span class="p">,</span> <span class="mi">1650</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="gp">   ....: </span>    <span class="n">m_d</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tricontourf</span><span class="p">(</span><span class="n">tri</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3280</span><span class="p">,</span> <span class="mi">3340</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">   ....: </span>    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">ax</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="n">a</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="gp">   ....: </span>    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">m_v</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Vs / m/s&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>                 <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">3500</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">4500</span><span class="p">])</span>
<span class="gp">   ....: </span>    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">m_t</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;T / K&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>                 <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">1100</span><span class="p">,</span> <span class="mi">1300</span><span class="p">,</span> <span class="mi">1500</span><span class="p">])</span>
<span class="gp">   ....: </span>    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">m_d</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Density / kg/m3&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
<span class="gp">   ....: </span>                 <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">3280</span><span class="p">,</span> <span class="mi">3300</span><span class="p">,</span> <span class="mi">3320</span><span class="p">,</span> <span class="mi">3340</span><span class="p">])</span>
<span class="gp">   ....: </span>

<span class="gp">In [13]: </span><span class="n">make_plot</span><span class="p">(</span><span class="n">MC</span><span class="p">,</span> <span class="o">-</span><span class="mf">50e3</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/figure.png" src="_images/figure.png" />
<section id="saving-to-file">
<h3>Saving to file<a class="headerlink" href="#saving-to-file" title="Permalink to this headline"></a></h3>
<p>The results can be saved to an output file with
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SaveFile()</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [14]: </span><span class="n">MC</span><span class="o">.</span><span class="n">SaveFile</span><span class="p">(</span><span class="s1">&#39;fileout.dat&#39;</span><span class="p">)</span>
<span class="go">Saving results to fileout.dat</span>
<span class="go">&gt; Done!</span>
</pre></div>
</div>
<p>The output file will contain metadata about the conversion parameters, for
example:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Temperature output
# Input file: VsSL2013.dat
# Velocity scale factor: 1.0
# Mantle composition:
# cpx - 0.133
# gnt - 0.153
# jd - 0.045
# ol - 0.617
# opx - 0.052
# XFe - 0.11
# Pressure calculation: AK135
# Wave frequency (Omega) / Hz: 0.02
# Anelasticity parameters: Sobolev et al. (1996)
# Alpha depending on: Nothing
# Columns:
# 1 - X
# 2 - Y
# 3 - Z / masl
# 4 - V_S / m/s
# 5 - T_syn / degC
# 6 - Rho / kg/m3
</pre></div>
</div>
</section>
</section>
<section id="optional-settings">
<span id="id1"></span><h2>Optional settings<a class="headerlink" href="#optional-settings" title="Permalink to this headline"></a></h2>
<section id="pressure-reference-model">
<span id="id2"></span><h3>Pressure reference model<a class="headerlink" href="#pressure-reference-model" title="Permalink to this headline"></a></h3>
<p>Pressure in <code class="xref py py-mod docutils literal notranslate"><span class="pre">VelocityConversion</span></code> is computed one-dimensionally using the
earth reference model <a class="reference external" href="http://rses.anu.edu.au/seismology/ak135/ak135f.html">AK135</a>. If desired, pressure
calculation can be performed using a homogeneous density. Therefore, define</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">MC</span><span class="o">.</span><span class="n">SimpleP</span> <span class="o">=</span> <span class="kc">True</span>

<span class="gp">In [16]: </span><span class="n">MC</span><span class="o">.</span><span class="n">SimpleRho</span> <span class="o">=</span> <span class="mf">3000.</span>  <span class="c1"># kg/m3, the default value</span>
</pre></div>
</div>
<p>If pressure was computed in this way, a note in the output metadata will be
added:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># Pressure calculation: Simplified
# Pressure calculation density: 3000.0 kg/m3
</pre></div>
</div>
</section>
<section id="attenuation-parameters">
<span id="id3"></span><h3>Attenuation parameters<a class="headerlink" href="#attenuation-parameters" title="Permalink to this headline"></a></h3>
<p>The attenuation model used can be changed. By default, parameterisation after
Sobolev et al. (1996) is used. If desired, it can be changed to the parameters
by Berckhemer et al. (1982) using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SetQMode()</span></code>:</p>
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [17]: </span><span class="n">MC</span><span class="o">.</span><span class="n">SetQMode</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Sobolev et al. (1996)</span>
<span class="go">Using Q after Sobolev et al. (1996)</span>
<span class="go">    a = 0.15</span>
<span class="go">    A = 0.148</span>
<span class="go">    H = 500000.0 J/mol</span>
<span class="go">    V = 2e-05 m3/mol</span>

<span class="gp">In [18]: </span><span class="n">MC</span><span class="o">.</span><span class="n">SetQMode</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Berckhemer et al. (1982)</span>
<span class="go">Using Q after Berckhemer et al. (1982)</span>
<span class="go">    a = 0.25</span>
<span class="go">    A = 0.0002</span>
<span class="go">    H = 584000.0 J/mol</span>
<span class="go">    V = 2.1e-05 m3/mol</span>
</pre></div>
</div>
</section>
<section id="thermal-expansion-coefficients">
<span id="thermal-expansion-coefficient"></span><h3>Thermal expansion coefficients<a class="headerlink" href="#thermal-expansion-coefficients" title="Permalink to this headline"></a></h3>
<p>Goes et al. (2000) use a temperature-dependent isobaric thermal expansion
coefficient. In general, the expansion coefficient will increase with
increasing pressure. However, the expansion coefficient is also sensitive to
pressure changes such that it will decrease with increasing pressure.
Temperature and pressure act against each other. I therefore implemented three
different options to use this expansion coefficient. They are defined using
<code class="xref py py-meth docutils literal notranslate"><span class="pre">SetAlpha()</span></code>:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 13%" />
<col style="width: 87%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">mode</span></code></p></td>
<td><p><strong>Explanation</strong></p></td>
</tr>
<tr class="row-even"><td><p>const</p></td>
<td><p>Constant. Use <span class="math notranslate nohighlight">\(\alpha_0\)</span> of Saxena and Shen (1992)</p></td>
</tr>
<tr class="row-odd"><td><p>T</p></td>
<td><p>T-dependent. Use the formulation of Saxena and Shen (1992)</p></td>
</tr>
<tr class="row-even"><td><div class="line-block">
<div class="line">PT</div>
<div class="line"><br /></div>
</div>
</td>
<td><div class="line-block">
<div class="line">Pressure- and temperature dependent. Uses data extracted from</div>
<div class="line">Hacker and Abers (2006)</div>
</div>
</td>
</tr>
</tbody>
</table>
<p>The temperature dependent alpha is defined by</p>
<div class="math notranslate nohighlight">
\[\alpha(T) = \alpha_0 + \alpha_1 T + \alpha_2 T^{-1} + \alpha_3 T^{-2}\]</div>
<p>Where the parameters <span class="math notranslate nohighlight">\(\alpha_i\)</span> are taken from Saxena and Shen (1992).
They are provided in the file <code class="docutils literal notranslate"><span class="pre">MinDB.csv</span></code>.</p>
<p>The data for pressure and temperature dependent behaviour were extracted from
the Excel worksheet by Hacker and Abers (2006) using a
<a class="reference external" href="https://github.com/cmeessen/VelocityConversion/blob/master/AlphaPT/AlphaPT.bas">VBA script</a>.</p>
<p>The following figure shows how the expansion coefficients compare for
clinopyroxene (<em>cpx</em>):</p>
<img alt="_images/alpha.png" src="_images/alpha.png" />
<div class="highlight-ipython notranslate"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">MC</span><span class="o">.</span><span class="n">SetAlpha</span><span class="p">(</span><span class="s1">&#39;const&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="as_terminal.html" class="btn btn-neutral float-right" title="Terminal application" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Christian Meeßen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>